rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    
    // === SIMPLIFIED RULES FOR SMART MESS APP ===
    
    // Allow authenticated users to access user_requests collection
    // This is needed for registration and email checking
    match /user_requests/{userId} {
      // Anyone can read user_requests for email checking during registration
      allow read: if true;
      
      // Authenticated users can create and update their own requests
      allow create, update: if request.auth != null;
      
      // Delete only for authenticated users (admins will be checked in app logic)
      allow delete: if request.auth != null;
    }
    
    // Allow access to admins collection for authentication checks
    match /admins/{adminId} {
      allow read, write: if request.auth != null;
    }
    
    // Allow authenticated users to access their data
    match /users/{userId} {
      allow read, write: if request.auth != null;
    }
    
    // Allow authenticated users to access all other collections
    // This provides functionality while maintaining basic security
    match /{document=**} {
      allow read, write: if request.auth != null;
    }
  }
}